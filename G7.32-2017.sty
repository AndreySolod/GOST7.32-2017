%Стиль предназначен для использования с классом 'article'
\RequirePackage[utf8]{inputenc}
\RequirePackage{mathtext}
\RequirePackage[russian]{babel}
\RequirePackage{float}
\RequirePackage{graphicx}
\RequirePackage[14pt]{extsizes}
\RequirePackage{vmargin}
\setmarginsrb{3cm}{2cm}{1.5cm}{2cm}{0pt}{0mm}{0pt}{0mm}
\setpapersize{A4}
\RequirePackage{indentfirst}
\RequirePackage{amsmath}
\RequirePackage{cmap}          % русский поиск в pdf
\RequirePackage{amsfonts}
\RequirePackage{amssymb}
\RequirePackage{tempora}
\RequirePackage{atveryend}
\sloppy

\newcounter{IndAppendix} %Счётчик приложений. Думаю, что желательно его подключить здесь.
\RequirePackage[tableposition=top]{caption} % Красивая подпись к рисункам и графикам
\DeclareCaptionLabelFormat{gostfigure}{Рисунок #2}
\DeclareCaptionLabelFormat{gosttable}{Таблица #2}
\DeclareCaptionLabelFormat{gostfigure2}{Рисунок \Asbuk{IndAppendix}.#2}
\DeclareCaptionLabelFormat{gosttable2}{Таблица \Asbuk{IndAppendix}.#2}
\DeclareCaptionLabelSeparator{gost}{~---~}
\captionsetup{labelsep=gost}
\captionsetup[figure]{labelformat=gostfigure}
\captionsetup[table]{labelformat=gosttable}

\newcommand{\@maketablecaption}[2]{ % Подпись к таблице --- слева вверху. Спасибо интернет за это.
\vskip\abovecaptionskip
\sbox\@tempboxa{#1 --- #2}%
\ifdim \wd\@tempboxa >\hsize
#1 --- #2\par
\else
\global \@minipagefalse
\hb@xt@\hsize{\box\@tempboxa}%
\fi
\vskip\belowcaptionskip}
\renewcommand{\table}
{\let\@makecaption\@maketablecaption\@float{table}}


\parindent=1.25cm % Красная строка, абзацный отступ
\setcounter{secnumdepth}{3} % В оглавление попадают все элементы до subsubsection
\linespread{1.3} % Отступ в 1.5 пункта

\renewcommand\large{\@setfontsize\large{15.5}{17}}

\RequirePackage{enumitem} % Переопределение обычного enumerate и itemize
\AddEnumerateCounter{\arabic}{\@arabic}{}
\setlist{nolistsep}
\renewcommand{\labelitemi}{---\hspace{1cm}}
\renewcommand{\labelenumi}{\arabic{enumi}.}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}

% Счётчики общего числа страниц, таблиц, рисунков и источников
\newcounter{totalpage}
\newcounter{totaltable} \setcounter{totaltable} {0}
\newcounter{totalfigure}\setcounter{totalfigure}{0}
\newcounter{totalappendix}

% Команды отображение общего числа ...
\newcommand{\totalpages}{\pageref{reftotalpages}}
\newcommand{\totaltables}{\ref{reftotaltables}}
\newcommand{\totalfigures}{\ref{reftotalfigures}}
\newcommand{\totalappendix}{\ref{reftotalappendix}}

% Стандартные части
\newcommand{\Executors}{% Список исполнителей
\newpage
\begin{center}
\noindent\bfseries СПИСОК ИСПОЛНИТЕЛЕЙ\\
\end{center}}

\newcommand{\Repherat}{% Реферат
\newpage
\begin{center}
\noindent\bfseries РЕФЕРАТ\\
\end{center}

Отчёт \totalpages{} c, \totalfigures{} рис., \totaltables{} табл., \totalappendix{} примеч.,
}

\renewcommand\contentsname{СОДЕРЖАНИЕ}% Содержание

\RequirePackage{tocloft}
\renewcommand{\cfttoctitlefont}{\hspace{0.38\textwidth} \bfseries\MakeUppercase}
%\renewcommand{\cftbeforetoctitleskip}{-1em}
\renewcommand{\cftsecfont}{\hspace{0pt}}
%\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsubsecfont}{\hspace{0em}}
%\renewcommand{\cftparskip}{-1mm}
%\renewcommand{\cftdotsep}{1}

\newcommand{\TermAndDefine}{% Термины и определения
\newpage
\begin{center}
\bfseries\noindent ТЕРМИНЫ И ОПРЕДЕЛЕНИЯ\\
\end{center}
\addcontentsline{toc}{section}{Термины и определения}
}

\newcommand{\listAbbreviationAndNotation}{% Перечень сокращений и обозначений
\newpage
\begin{center}
\bfseries\noindent ПЕРЕЧЕНЬ СОКРАЩЕНИЙ И ОБОЗНАЧЕНИЙ
\end{center}
\addcontentsline{toc}{section}{Перечень сокращений и обозначений}
}

\newcommand{\Intoduction}{% Введение
\newpage
\begin{center}
\noindent\bfseries ВВЕДЕНИЕ
\end{center}
\addcontentsline{toc}{section}{Введение}
}

\renewcommand{\section}{\newpage\@startsection{section}{1}% Секция основного текста
{\parindent}{-3.5ex plus -1ex minus -.2ex}{2.3ex plus.2ex}%
{\normalfont\large\bfseries\hyphenpenalty=9999
}}

\renewcommand{\subsection}{\@startsection{subsection}{2}{2em}% Подсекция основного текста
{-3.25ex plus-1ex minus-.2ex}{1.5ex plus .2ex}%
{\normalfont\normalsize\bfseries\hyphenpenalty=9999
}}

\renewcommand{\l@section}{\@dottedtocline{1}{0em}{2.3em}}

%Перечисления:

\newenvironment{GostItemize}{%Через тире
\renewcommand{\item}{\par
--- }
}{}

\newcounter{my:enumi}
\newcounter{my:enumii}[my:enumi]
\newcounter{my:enumiii}[my:enumii]

\newenvironment{GostEnumerate}{%Через цифры
\setcounter{my:enumi}{0}
\setcounter{my:enumii}{0}
\setcounter{my:enumiii}{0}
\renewcommand{\item}{\par
\refstepcounter{my:enumi}
\arabic{my:enumi} }

\renewenvironment{GostEnumerate}{
\setcounter{my:enumii}{0}
\setcounter{my:enumiii}{0}
\renewcommand{\item}{\par
\refstepcounter{my:enumii}
\arabic{my:enumi}.\arabic{my:enumii} }

\renewenvironment{GostEnumerate}{
\setcounter{my:enumiii}{0}
\renewcommand{\item}{\par
\refstepcounter{my:enumiii}
\arabic{my:enumi}.\arabic{my:enumii}.\arabic{my:enumiii} }
}{}
}{}
}{}

\newcounter{symbol:enumi} % Символьная нумерация
\newenvironment{GostSymbolEnumerate}{
\setcounter{symbol:enumi}{0}
\renewcommand{\item}{\par
\refstepcounter{symbol:enumi}
\asbuk{symbol:enumi}) }}{}

\newcommand{\Conclusion}{%Заключение
\newpage
\begin{center}
\bfseries\noindent ЗАКЛЮЧЕНИЕ\\
\end{center}
\addcontentsline{toc}{section}{Заключение}
}

\newcommand{\ListSource}{%Список использованных источников
\newpage
\begin{center}
\bfseries\noindent СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ
\end{center}
\addcontentsline{toc}{section}{Список использованных источников}
}

\newcommand{\Appendix}{%% Приложение
\newpage\refstepcounter{IndAppendix}
\begin{center}
\bfseries\noindent ПРИЛОЖЕНИЕ \Asbuk{IndAppendix}
\end{center}
\addcontentsline{toc}{section}{Приложение \Asbuk{IndAppendix}}
\captionsetup[figure]{labelformat=gostfigure2}
\captionsetup[table]{labelformat=gosttable2}
\addtocounter{totaltable}{\c@table}
\setcounter{table}{0}
\addtocounter{totalfigure}{\c@figure}
\setcounter{figure}{0}
}

\newcommand{\Finish}{
\label{reftotalpages}
{\addtocounter{totalfigure}{\c@table}
\addtocounter{totalfigure}{-1}
\refstepcounter{totalfigure}\label{reftotalfigures}}
{\addtocounter{totaltable}{\c@figure}
\addtocounter{totaltable}{-1}
\refstepcounter{totaltable}\label{reftotaltables}}
\addtocounter{totalappendix}{\c@IndAppendix}\label{reftotalappendix}
}

%\addtocounter{page}{-1}
%\refstepcounter{page} \label{reftotalpages}
%\addtocounter{table}{-1}
%\refstepcounter{table} \label{reftotaltables}
%\addtocounter{figure}{-1}
%\refstepcounter{figure} \label{reftotalfigures}
%\addtocounter{IndAppendix}
%\refstepcounter{IndAppendix}\label{reftotalappendix}